<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ù…ÙŠØ¹ - ØªØ­ÙÙŠØ¸ Ù…Ø³Ø¬Ø¯ Ø§Ù„Ø±Ø­Ù…Ø©</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f7f7f7;
      color: #333;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    img.logo {
      max-width: 120px;
      display: block;
      margin: 0 auto 1rem;
    }
    h1 {
      text-align: center;
      color: #006837;
      font-size: 1.2rem;
    }
    label {
      display: block;
      font-weight: bold;
      margin-bottom: 0.3rem;
    }
    input, select, button {
      padding: 0.5rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      width: 100%;
    }
    input[readonly] {
      background-color: #eee;
    }
    .section-title {
      margin-top: 2rem;
      font-weight: bold;
      color: #005522;
      border-bottom: 1px solid #ccc;
      padding-bottom: 4px;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }
    .col {
      flex: 1 1 0;
      min-width: 120px;
    }
    button {
      background-color: #006837;
      color: white;
      font-weight: bold;
      margin-top: 2rem;
      cursor: pointer;
    }
    button:hover {
      background-color: #00502a;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="Ø´Ø¹Ø§Ø± ØªØ­ÙÙŠØ¸ Ù…Ø³Ø¬Ø¯ Ø§Ù„Ø±Ø­Ù…Ø©.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø³Ø¬Ø¯" class="logo" />
    <h1>Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨</h1>

    <div class="row">
      <div class="col">
        <label for="studentName">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
        <select id="studentName" required>
          <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨</option>
          <option>Ø§Ø­Ù…Ø¯ Ø§Ù„Ù‚ØµØ§Øµ</option>
          <option>Ø§ÙŠØ§Ø¯ Ø§Ù„Ø­Ù…Ù„ÙŠ</option>
          <option>Ø£Ø³Ø§Ù…Ø© Ø§Ù„Ø¬Ø§Ø¨ÙŠ</option>
          <option>Ø£Ù…ÙŠØ± Ø¨Ø±ØºÙˆØª</option>
          <option>Ø¨Ø±Ø§Ø¡ Ø§Ù„ÙƒØ³Ù…</option>
          <option>ØªÙŠÙ… Ø§Ø¨Ùˆ Ø§Ù„Ù†ØµØ±</option>
          <option>Ø¬Ø§Ø¯ Ø§Ø¨Ùˆ Ø´Ø¹Ø±</option>
          <option>Ø¬Ù„Ø§Ù„ Ø§Ù„Ø¯ÙŠÙ† Ø­Ø¨Ù†ÙƒÙŠ</option>
          <option>Ø­Ø³ÙŠÙ† Ø§Ù„Ø·Ø±Ø²ÙŠ</option>
          <option>Ø±ÙŠØ§Ù† Ø¨Ù‚Ø§Ø¹ÙŠ</option>
          <option>Ø¹Ø¨Ø¯ Ø§Ù„Ø§Ù„Ù‡ Ø§Ù„Ø³Ø¨Ø§Ø¹ÙŠ</option>
          <option>Ø¹Ù…Ø± Ø­Ù„ÙˆØ§Ù†ÙŠ</option>
          <option>ÙƒØ±ÙŠÙ… Ø­Ù…Ø²Ø©</option>
          <option>ÙƒØ±ÙŠÙ… Ø¶ÙØ¯Ø¹</option>
          <option>Ù„Ø¤ÙŠ Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ù‚ÙŠ</option>
          <option>Ù…Ø­Ù…Ø¯ Ø´Ù†Ù†</option>
          <option>ÙŠØ²Ù† Ø§Ù„Ù†Ø¬Ø§Ø±</option>
          <option>ÙŠÙˆØ³Ù Ù†Ø¹Ù…Ø§Ù†</option>
        </select>
      </div>
      <div class="col">
        <label for="date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
        <input type="date" id="date" required />
      </div>
      <div class="col">
        <label for="day">Ø§Ù„ÙŠÙˆÙ…</label>
        <select id="day" required>
          <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</option>
          <option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option>
          <option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
        </select>
      </div>
    </div>

    <div class="section-title">ØªØ³Ù…ÙŠØ¹ Ø§Ù„Ø­ÙØ¸</div>
    <div class="row">
      <div class="col">
        <label for="sura">Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø©</label>
        <input type="text" id="sura" required />
      </div>
      <div class="col">
        <label for="fromAya">Ù…Ù† Ø¢ÙŠØ©</label>
        <input type="number" id="fromAya" required />
      </div>
      <div class="col">
        <label for="toAya">Ø¥Ù„Ù‰ Ø¢ÙŠØ©</label>
        <input type="number" id="toAya" required />
      </div>
      <div class="col">
        <label for="rating">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</label>
        <input type="number" id="rating" min="5" max="10" required />
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label for="lines">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø±</label>
        <input type="number" id="lines" oninput="calcPages('lines','pages')" required />
      </div>
      <div class="col">
        <label for="pages">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª</label>
        <input type="number" id="pages" readonly />
      </div>
    </div>

    <div class="section-title">ØªØ³Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
    <div class="row">
      <div class="col">
        <label for="revSura">Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø©</label>
        <input type="text" id="revSura" required />
      </div>
      <div class="col">
        <label for="revFrom">Ù…Ù† Ø¢ÙŠØ©</label>
        <input type="number" id="revFrom" required />
      </div>
      <div class="col">
        <label for="revTo">Ø¥Ù„Ù‰ Ø¢ÙŠØ©</label>
        <input type="number" id="revTo" required />
      </div>
      <div class="col">
        <label for="revRating">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</label>
        <input type="number" id="revRating" min="5" max="10" required />
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label for="revLines">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø±</label>
        <input type="number" id="revLines" oninput="calcPages('revLines','revPages')" required />
      </div>
      <div class="col">
        <label for="revPages">Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª</label>
        <input type="number" id="revPages" readonly />
      </div>
    </div>

    <button onclick="submitToGoogle()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
  </div>

  <script>
    function calcPages(inputId, outputId) {
      const val = parseFloat(document.getElementById(inputId).value);
      document.getElementById(outputId).value = val ? (val / 15).toFixed(2) : '';
    }

    async function submitToGoogle() {
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
      const requiredFields = [
        'studentName','date','day',
        'sura','fromAya','toAya','lines','rating',
        'revSura','revFrom','revTo','revLines','revRating'
      ];
      for (let id of requiredFields) {
        const el = document.getElementById(id);
        if (!el.value) {
          alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
          el.focus();
          return;
        }
        if (el.type === 'number' && el.min && el.max) {
          const num = Number(el.value);
          if (num < Number(el.min) || num > Number(el.max)) {
            alert('ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©');
            el.focus();
            return;
          }
        }
      }

      const payload = {
        studentName: document.getElementById('studentName').value,
        date: document.getElementById('date').value,
        day: document.getElementById('day').value,
        sura: document.getElementById('sura').value,
        fromAya: document.getElementById('fromAya').value,
        toAya: document.getElementById('toAya').value,
        lines: document.getElementById('lines').value,
        pages: document.getElementById('pages').value,
        rating: document.getElementById('rating').value,
        revSura: document.getElementById('revSura').value,
        revFrom: document.getElementById('revFrom').value,
        revTo: document.getElementById('revTo').value,
        revLines: document.getElementById('revLines').value,
        revPages: document.getElementById('revPages').value,
        revRating: document.getElementById('revRating').value
      };

      try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbwH5xMmayVkGgnLF4TVsoDlK3KnXNQeWUnczuoNJS9hNk2mrqHhpq6cpIIrTBREVhk9dw/exec', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
        });
        const text = await response.text();
        alert('Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø®Ø§Ø¯Ù…: ' + text);
        // ÙŠÙ…ÙƒÙ†Ùƒ Ù‡Ù†Ø§ ØªÙØ±ÙŠØº Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø£Ùˆ Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
      } catch (err) {
        console.error(err);
        alert('Ù‡Ù†Ø§Ù„Ùƒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      }
    }
  </script>
</body>
</html>
